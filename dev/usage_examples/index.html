<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usage and Examples · BLR.jl</title><meta name="title" content="Usage and Examples · BLR.jl"/><meta property="og:title" content="Usage and Examples · BLR.jl"/><meta property="twitter:title" content="Usage and Examples · BLR.jl"/><meta name="description" content="Documentation for BLR.jl."/><meta property="og:description" content="Documentation for BLR.jl."/><meta property="twitter:description" content="Documentation for BLR.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BLR.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Usage and Examples</a><ul class="internal"><li><a class="tocitem" href="#Reproducing-the-line-profile-and-transfer-function-shown-in-[CM96](https://ui.adsabs.harvard.edu/abs/1996ApJ...466..704C/abstract)"><span>Reproducing the line profile and transfer function shown in CM96</span></a></li><li><a class="tocitem" href="#Reproducing-a-sample-cloud-model-from-[Pancoast2014](https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract)-results-(show-geometry-line-and-delay-profiles)"><span>Reproducing a sample cloud model from Pancoast+2014 results (show geometry + line and delay profiles)</span></a></li><li><a class="tocitem" href="#Reproducing-the-line-and-phase-profiles-shown-in-Long2023"><span>Reproducing the line and phase profiles shown in Long+2023</span></a></li><li><a class="tocitem" href="#Reproducing-the-combined-model-line-and-delay-profiles-shown-in-Long2025"><span>Reproducing the combined model line and delay profiles shown in Long+2025</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Usage and Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usage and Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/kirklong/BLR.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/kirklong/BLR.jl/blob/main/docs/src/usage_examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Usage-and-Examples"><a class="docs-heading-anchor" href="#Usage-and-Examples">Usage and Examples</a><a id="Usage-and-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-and-Examples" title="Permalink"></a></h1><p>This guide explores a few more complicated tasks one might wish to use this code for. </p><ul><li><a href="#Reproducing-the-line-profile-and-transfer-function-shown-in-[CM96](https://ui.adsabs.harvard.edu/abs/1996ApJ...466..704C/abstract)">Reproducing the line profile and transfer function shown in CM96</a></li><li class="no-marker"><ul><li><a href="#Generating-the-line-profile">Generating the line profile</a></li><li><a href="#Generating-the-transfer-function">Generating the transfer function</a></li></ul></li><li><a href="#Reproducing-a-sample-cloud-model-from-[Pancoast2014](https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract)-results-(show-geometry-line-and-delay-profiles)">Reproducing a sample cloud model from Pancoast+2014 results (show geometry + line and delay profiles)</a></li><li><a href="#Reproducing-the-line-and-phase-profiles-shown-in-Long2023">Reproducing the line and phase profiles shown in Long+2023</a></li><li><a href="#Reproducing-the-combined-model-line-and-delay-profiles-shown-in-Long2025">Reproducing the combined model line and delay profiles shown in Long+2025</a></li></ul><h2 id="Reproducing-the-line-profile-and-transfer-function-shown-in-[CM96](https://ui.adsabs.harvard.edu/abs/1996ApJ...466..704C/abstract)"><a class="docs-heading-anchor" href="#Reproducing-the-line-profile-and-transfer-function-shown-in-[CM96](https://ui.adsabs.harvard.edu/abs/1996ApJ...466..704C/abstract)">Reproducing the line profile and transfer function shown in <a href="https://ui.adsabs.harvard.edu/abs/1996ApJ...466..704C/abstract">CM96</a></a><a id="Reproducing-the-line-profile-and-transfer-function-shown-in-[CM96](https://ui.adsabs.harvard.edu/abs/1996ApJ...466..704C/abstract)-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducing-the-line-profile-and-transfer-function-shown-in-[CM96](https://ui.adsabs.harvard.edu/abs/1996ApJ...466..704C/abstract)" title="Permalink"></a></h2><p>CM96 showed that disk-wind models of the BLR could produce single-peaked line profiles, and as part of their results they generated a hypothetical 2D transfer function for a disk-wind BLR as applied to NGC 5548. We can reproduce such a map with just a few lines of code using <code>BLR.jl</code>.</p><p>First, let&#39;s define the model using <a href="../api/#BLR.DiskWindModel-NTuple{4, Float64}"><code>DiskWindModel</code></a>: </p><pre><code class="language-julia hljs">mCM96 = BLR.DiskWindModel(3000.,100.,1.,75/180*π,
        nr=5096,nϕ=1024,scale=:log,f1=1.0,f2=1.0,f3=0.0,f4=0.0,
        I=BLR.DiskWindIntensity,v=BLR.vCircularDisk,τ=5.0,reflect=false)</code></pre><p>We use the parameters from CM96 for <span>$\bar{r} = 3000\rm{r_s}$</span>, <span>$r_{\rm{fac}} = 10^2$</span>, <span>$\alpha = 1$</span>, and <span>$i = 75^{\circ}$</span>. CM96 considered the case of radial and Keplerian shear only, so we turn these gradients on by setting <span>$f_1 = 1$</span> and <span>$f_2 = 1$</span> (radial and Keplerian shear, respectively) and turn off the remaining velocity gradients by setting <span>$f_3 = 0$</span> and <span>$f_4 = 0$</span>. </p><p>To have a well sampled model grid we pick <code>nr=5096</code> and <code>nϕ=1024</code> with <code>scale=:log</code>, which will result in the returned model object having 5096 &quot;rings&quot; in our circular camera aperture with each ring holding 1024 grid cells evenly divided in <span>$\\phi$</span> space. </p><p>While this is the default, for the sake of this demonstration we also set <a href="../api/#BLR.DiskWindIntensity-Tuple{}"><code>I=BLR.DiskWindIntensity</code></a> to explicitly tell the model to use the intensity formulation first proposed in CM96 (and using the &quot;f&quot; parameter language introduced in Long+2023). We also tell the model to calculate the velocities according to the built in function <a href="../api/#BLR.vCircularDisk-Tuple{}"><code>BLR.vCircularDisk</code></a>, which simply calculates the projected line of sight velocity as <span>$v = \sqrt{\frac{\rm{r_s}}{2r}}\sin i \sin\phi$</span>. </p><p>Finally, while not required, we set <code>τ = 5.0</code> as we want our disk to be optically thick and <code>reflect = false</code> as we do not want to move any points from the back to the front. </p><h3 id="Generating-the-line-profile"><a class="docs-heading-anchor" href="#Generating-the-line-profile">Generating the line profile</a><a id="Generating-the-line-profile-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-the-line-profile" title="Permalink"></a></h3><p>Now that we have a model, let&#39;s get the line profile and store it in our model:</p><pre><code class="language-julia hljs">p = BLR.getProfile(mCM96,:line,bins=101) #get the line profile using 101 bins in velocity-space, otherwise using default params
BLR.setProfile!(mCM96,p) #store the line profile in our model structure</code></pre><p>We can do a quick visualization with the built-in <a href="../api/#BLR.profile!-Tuple"><code>profile</code></a> macro:</p><pre><code class="language-julia hljs">BLR.profile(mCM96) #plot all profiles stored in model object, here we only have set :line so only :line will be plotted</code></pre><p>Which should return a plot like this (left panel, right panel is Figure 2 in CM96):</p><p><img src="../LPCM96_quickComparison.png" alt="result of BLR.profile"/></p><p>Note that the y-axis units are arbitrary and the x-axis is in units of velocity [<span>$c$</span>], not <span>$\lambda$</span> as published in Fig 2 of <a href="https://articles.adsabs.harvard.edu/pdf/1996ApJ...466..704C">CM96</a>, but the shape clearly matches their result that the line profile for such a model should be single-peaked. This is also showing only the full model line profile (thei solid line), not the data or other models. We could reproduce their plot exactly by rescaling our flux and converting from velocity-space to wavelength space as well as plotting the data and a model line profile with azimuthally isotropic emission, but we will leave that as an exercise for the motivated reader...</p><h3 id="Generating-the-transfer-function"><a class="docs-heading-anchor" href="#Generating-the-transfer-function">Generating the transfer function</a><a id="Generating-the-transfer-function-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-the-transfer-function" title="Permalink"></a></h3><p>It is similarly easy to use <code>BLR.jl</code> to generate transfer functions for any user-defined model. In looking at Figure 4 of <a href="https://articles.adsabs.harvard.edu/pdf/1996ApJ...466..704C">CM96</a> we see that their y-axis (delays) spans 0-20 days and the x-axis (projected velocity) -12-12 (<span>$10^8$</span> <span>$\rm{cm}$</span> <span>$\rm{s}^-1$</span>). To match our model result to theirs, we first need to convert our units of <span>$\rm{r_s}$</span> to the more physical unit of days. CM96 used <span>$M_{\rm{NGC5548}} \approx 10^8 \rm{M_{\odot}}$</span>, which means we can calculate the conversion factor as:</p><pre><code class="language-julia hljs">M = 1e8*2e30 #kg
rs = 2*M*6.67e-11/9e16 #2GM/c^2
rsDay = rs/3e8/3600/24 #days</code></pre><p>We only need to obtain the transfer function <span>$\Psi$</span> over the range shown in CM96, so let&#39;s define the <code>tEdges</code> and <code>vEdges</code> we want to use to match their result and then generate the transfer function:</p><pre><code class="language-julia hljs">tEdges = collect(range(0.0,stop=20.0/rsDay,length=101)) #will generate 100 bins, convert 20 days upper limit to units of rs
vEdges = collect(range(-0.04,stop=0.04,length=101)) #0.04c ~12*1e8 cm/s
Ψ = BLR.getΨ(mCM96,vEdges,tEdges) #obtain transfer function with our supplied bin edges </code></pre><p>Note that in Fig. 4 of <a href="https://articles.adsabs.harvard.edu/pdf/1996ApJ...466..704C">CM96</a> the edges between the colors are sharp, indicating that they used discrete bins in their image to better showcase structure. While these levels are not explicitly supplied in the paper, we can make a good guess that they are somewhat evenly spaced logarithmic bins. To transform our <span>$\Psi$</span> to match their binning, we can do something like: </p><pre><code class="language-julia hljs">function getΨMatch(ΨBinned,levels=[-0.4*i for i=0:11]) #generate constant log10 bins of Ψ
    #fills intervals that are closed at the top;
    #that is, for regions z1 and z2 the filled region is z1 &lt; Z &lt;= z2&quot;

    logΨ = log10.(ΨBinned)
    res = zeros(size(logΨ))
    mask = (logΨ .&lt;= levels[2]) .&amp; (logΨ .&gt;= levels[1])
    res[mask] .= (levels[1]+levels[2])/2
    for i=2:length(levels)-1
        mask = (logΨ .&lt; levels[i]) .&amp; (logΨ .&gt;= levels[i+1])
        res[mask] .= (levels[i]+levels[i+1])/2
    end
    mask = (logΨ .&lt; levels[end])
    res[mask] = logΨ[mask]
    return res
end
ΨDiscrete = getΨMatch(Ψ./maximum(Ψ)) #normalize and generate discrete bins</code></pre><p>All that&#39;s left to do now is visualize the result, which we will do with the <code>heatmap</code> function from Julia&#39;s <code>Plots.jl</code>:</p><pre><code class="language-julia hljs">heatmap(reverse(vEdges).*3e10/1e8,tEdges.*rsDay,ΨDiscrete&#39;,
    ylims=(0,20),xlims=(-12,12),clims=(-4.4,0.0),cbar=false,
    xlabel=&quot;v (10⁸ cm/s)&quot;,ylabel=&quot;τ (days)&quot;,minorticks=true,
    tickdirection=:out,widen=false,size=(500,500))</code></pre><p>Which should return something like this (left plot, right plot is Fig 4. in CM96):</p><p><img src="../CM96_Psi_quickComparison.png" alt="2D Ψ map"/></p><p>While our binning is a little off/coarser than in CM96, this is clearly a pretty good match for a quick and dirty calculation. </p><p>A few final notes: </p><ol><li>In the plotting function we reversed the velocity bins. This is because in CM96 they defined their disk as rotating in the opposite direction as our model defines things (they use <span>$\cos\phi$</span> for the projected velocity calculation instead of <span>$\sin\phi$</span>), so to compare directly to them we need to flip the direction our disk rotates by default. </li><li>Also note that when plotting we use <code>ΨDiscrete&#39;</code> because heatmap expects the shape of the image variable to be flipped from how <code>BLR.jl</code> calculates it (the shape of <code>Ψ</code> when returned is (number of velocity bins, number of t bins)). </li><li>If you wanted to generate just the 1D response function shown in CM96 figure 5, we could do that too with something like: <code>tCenters, Ψt = BLR.getΨt(mCM96,101,10/rsDay)</code>. </li></ol><h2 id="Reproducing-a-sample-cloud-model-from-[Pancoast2014](https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract)-results-(show-geometry-line-and-delay-profiles)"><a class="docs-heading-anchor" href="#Reproducing-a-sample-cloud-model-from-[Pancoast2014](https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract)-results-(show-geometry-line-and-delay-profiles)">Reproducing a sample cloud model from <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a> results (show geometry + line and delay profiles)</a><a id="Reproducing-a-sample-cloud-model-from-[Pancoast2014](https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract)-results-(show-geometry-line-and-delay-profiles)-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducing-a-sample-cloud-model-from-[Pancoast2014](https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract)-results-(show-geometry-line-and-delay-profiles)" title="Permalink"></a></h2><p>We can also generate &quot;cloud&quot;/thick-disk models of the BLR similar to <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a> easily with <code>BLR.jl</code>. In this section we will reproduce part of Figure 4 in <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a>, which shows five different model BLRs and their 1D transfer functions with the following parameters: </p><table><tr><th style="text-align: center">parameter</th><th style="text-align: center">model 1</th><th style="text-align: center">model 2</th></tr><tr><td style="text-align: center"><span>$r_{\rm{mean}}$</span> [days]</td><td style="text-align: center">4.0</td><td style="text-align: center">4.0</td></tr><tr><td style="text-align: center"><span>$F$</span></td><td style="text-align: center">0.25</td><td style="text-align: center">0.25</td></tr><tr><td style="text-align: center"><span>$\beta$</span></td><td style="text-align: center">1.0</td><td style="text-align: center">0.8</td></tr><tr><td style="text-align: center"><span>$\theta_o$</span> [deg]</td><td style="text-align: center">40</td><td style="text-align: center">30</td></tr><tr><td style="text-align: center"><span>$i$</span> [deg]</td><td style="text-align: center">20</td><td style="text-align: center">20</td></tr><tr><td style="text-align: center"><span>$\kappa$</span></td><td style="text-align: center">-0.4</td><td style="text-align: center">-0.4</td></tr><tr><td style="text-align: center"><span>$\gamma$</span></td><td style="text-align: center">5.0</td><td style="text-align: center">5.0</td></tr><tr><td style="text-align: center"><span>$\xi$</span></td><td style="text-align: center">0.3</td><td style="text-align: center">0.1</td></tr><tr><td style="text-align: center"><span>$f_{\rm{ellipse}}$</span></td><td style="text-align: center">0.0</td><td style="text-align: center">1.0</td></tr><tr><td style="text-align: center"><span>$f_{\rm{flow}}$</span></td><td style="text-align: center">0.0</td><td style="text-align: center">-</td></tr><tr><td style="text-align: center"><span>$\theta_e$</span> [deg]</td><td style="text-align: center">0.0</td><td style="text-align: center">-</td></tr><tr><td style="text-align: center"><span>$\sigma_{\rm{turb}}$</span></td><td style="text-align: center">0.0</td><td style="text-align: center">0.0</td></tr></table><p>First, we initialize model structs for both of these cases:</p><pre><code class="language-julia hljs">M = 10^(6.5)*2e30 #kg, from Pancoast+2014
rs = 2*6.67e-11*M/9e16 #2GM/c^2, m
rsDay = rs/3e8/3600/24 #days^C #days -- model expects μ in units of rₛ
nClouds = 100_000 #small number of clouds just for demonstration
mP1 = BLR.cloudModel(nClouds,μ=4/rsDay,F=0.25,β=1.0,θₒ=40/180*π,i=20/180*π,
        κ=-0.4,γ=5.0,ξ=0.3,fEllipse=0.0,fFlow=0.0,θₑ=0.0,σₜ=0.0,
        σρc=0.0,σΘᵣ=0.0,σΘc=0.0,σρᵣ=0.0,
        I=BLR.cloudIntensity,v=BLR.vCloudTurbulentEllipticalFlow,τ=0.0)
mP2 = BLR.cloudModel(nClouds,μ=4/rsDay,F=0.25,β=0.8,θₒ=30/180*π,i=20/180*π,
        κ=-0.4,γ=5.0,ξ=0.1,fEllipse=1.0,σₜ=0.0,
        fFlow=0.0,θₑ=0.0,σρc=0.0,σΘᵣ=0.0,σΘc=0.0,σρᵣ=0.0,
        I=BLR.cloudIntensity,v=BLR.vCloudTurbulentEllipticalFlow,τ=0.0)</code></pre><p>Where the first argument passed to <a href="../api/#BLR.cloudModel-Tuple{Int64}"><code>cloudModel</code></a> is the number of clouds to generate (here we use a relatively small number just for demonstration purposes), and the keyword arguments supplied mostly correspond to the values in the table above and are fully described in <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a>. The extra keyword arguments set to 0 but not in the table are options not used in this calculation, and the final line specifies that we would like the intensity calculated with the <a href="../api/#BLR.cloudIntensity-Tuple{}"><code>cloudIntensity</code></a> function, the velocities calculated with <a href="../api/#BLR.vCloudTurbulentEllipticalFlow-Tuple{}"><code>vCloudTurbulentEllipticalFlow</code></a>, and that the optical depth of the cloud is 0.</p><p>To compare to Figure 4 in <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a> we can again generate transfer functions for both models:</p><pre><code class="language-julia hljs">vEdges = collect(range(-0.015,stop=0.015,length=51)) #Δλ/λ ~ v/c
tEdges = collect(range(0.0,stop=20.0/rsDay,length=51))
Ψ1 = BLR.getΨ(mP1,vEdges,tEdges)
Ψ2 = BLR.getΨ(mP2,vEdges,tEdges)
p1 = heatmap(reverse(vEdges.*3e5),tEdges.*rsDay,(Ψ1&#39;./maximum(Ψ1)),ylims=(0,20),cbar=false,
    xlabel=&quot;Δv (km/s)&quot;,ylabel=&quot;Lag (days)&quot;,minorticks=true,tickdirection=:out,
    widen=false,size=(500,500),guidefontsize=18,tickfontsize=16)
p2 = heatmap(reverse(vEdges.*3e5),tEdges.*rsDay,(Ψ2&#39;./maximum(Ψ2)),ylims=(0,20),cbar=false,
    xlabel=&quot;Δv (km/s)&quot;,ylabel=&quot;Lag (days)&quot;,minorticks=true,tickdirection=:out,
    widen=false,size=(500,500),guidefontsize=18,tickfontsize=16)</code></pre><p>Which should produce something like the right column of plots in the comparison below (top plot = <code>p1</code> and bottom = <code>p2</code>):</p><p><img src="../P14_Psi_quickComparison.png" alt="2D cloud Ψ maps"/></p><p>Note that again we are just trying to roughly match the color scale by eye, but the general shape and morphology looks good. Also note that again we had to flip the left/right sides of the system because of the way the default velocity function/<span>$\phi$</span> grid is setup in our model (<code>BLR.jl</code> defaults to the left side rotating towards you while <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a> has the left side rotating away). </p><p>We can also quickly visualize the geometry of the system from any angle (i.e. to compare to the rightmost panel of Fig. 4 in <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a>) using the built-in <a href="../api/#BLR.plot3d-Tuple"><code>plot3d</code></a> macro:</p><pre><code class="language-julia hljs">BLR.plot3d(mP1,:I,cam=(10,10)) #visualize the system with points colored by their intensity with a camera at 10 deg azimuth and altitude</code></pre><p>Iterating this over a wide variety of camera angles one can produce fun 3D visualizations of the BLR models like the gifs below:</p><table><tr><th style="text-align: center">model 1</th><th style="text-align: center">model 2</th></tr><tr><td style="text-align: center"><img src="../mP1.gif" alt="gif of model 1 geometry"/></td><td style="text-align: center"><img src="../mP2.gif" alt="gif of model 2 geometry"/></td></tr></table><p>Comparing to the stills in Figure 4 of <a href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.3055P/abstract">Pancoast+2014</a> again shows good agreement (although note that here we are using more clouds than they did). </p><h2 id="Reproducing-the-line-and-phase-profiles-shown-in-Long2023"><a class="docs-heading-anchor" href="#Reproducing-the-line-and-phase-profiles-shown-in-Long2023">Reproducing the line and phase profiles shown in Long+2023</a><a id="Reproducing-the-line-and-phase-profiles-shown-in-Long2023-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducing-the-line-and-phase-profiles-shown-in-Long2023" title="Permalink"></a></h2><h2 id="Reproducing-the-combined-model-line-and-delay-profiles-shown-in-Long2025"><a class="docs-heading-anchor" href="#Reproducing-the-combined-model-line-and-delay-profiles-shown-in-Long2025">Reproducing the combined model line and delay profiles shown in Long+2025</a><a id="Reproducing-the-combined-model-line-and-delay-profiles-shown-in-Long2025-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducing-the-combined-model-line-and-delay-profiles-shown-in-Long2025" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Friday 20 June 2025 05:05">Friday 20 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
