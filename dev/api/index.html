<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · BLR.jl</title><meta name="title" content="API · BLR.jl"/><meta property="og:title" content="API · BLR.jl"/><meta property="twitter:title" content="API · BLR.jl"/><meta name="description" content="Documentation for BLR.jl."/><meta property="og:description" content="Documentation for BLR.jl."/><meta property="twitter:description" content="Documentation for BLR.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BLR.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../usage_examples/">Usage and Examples</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/kirklong/BLR.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/kirklong/BLR.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.DiskWindModel-NTuple{4, Float64}" href="#BLR.DiskWindModel-NTuple{4, Float64}"><code>BLR.DiskWindModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiskWindModel(r̄::Float64, rFac::Float64, α::Float64, i::Float64; rot::Float64=0.0, nr::Int=128, nϕ::Int=256, scale::Symbol=:log, kwargs...)</code></pre><p>Uses the model constructor to create a DiskWind model of the BLR as detailed in Long+2023 and Long+2025.</p><p><strong>Parameters</strong></p><ul><li><code>r̄::Float64</code>: Mean radius of model (in terms of <span>$r_s$</span>)</li><li><code>rFac::Float64</code>: Radius factor</li><li><code>α::Float64</code>: Power-law source function scaling</li><li><code>i::Float64</code>: Inclination angle in radians</li><li><code>rot::Float64=0.0</code>: Rotation of system plane about z-axis in radians</li><li><code>nr::Int=128</code>: Number of radial bins</li><li><code>nϕ::Int=256</code>: Number of azimuthal bins</li><li><code>scale::Symbol=:log</code>: Radial binning scale (<code>:log</code> or <code>:linear</code>)</li><li><code>kwargs...</code>: Extra keyword arguments for model constructor (see examples)</li></ul><p><strong>Returns</strong></p><ul><li><code>model</code> object</li></ul><p><strong>Note</strong></p><p>Similar to another DiskWind model constructor but here we pass <code>r̄</code>, <code>rFac</code>, and <code>α</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L530-L551">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.DiskWindModel-Tuple{Float64, Float64, Float64}" href="#BLR.DiskWindModel-Tuple{Float64, Float64, Float64}"><code>BLR.DiskWindModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiskWindModel(rMin::Float64, rMax::Float64, i::Float64; nr::Int=128, nϕ::Int=256, I::Function=DiskWindIntensity, v::Function=vCircularDisk, scale::Symbol=:log, kwargs...)</code></pre><p>Uses the model constructor to create a DiskWind model of the BLR as detailed in Long+2023 and Long+2025.</p><p><strong>Parameters</strong></p><ul><li><code>rMin::Float64</code>: Minimum radius of model (in terms of <span>$r_s$</span>)</li><li><code>rMax::Float64</code>: Maximum radius of model (in terms of <span>$r_s$</span>)</li><li><code>i::Float64</code>: Inclination angle in radians (all rings have the same inclination)</li><li><code>nr::Int=128</code>: Number of radial bins</li><li><code>nϕ::Int=256</code>: Number of azimuthal bins</li><li><code>I::Function=DiskWindIntensity</code>: Intensity function</li><li><code>v::Function=vCircularDisk</code>: Velocity function</li><li><code>scale::Symbol=:log</code>: Radial binning scale (<code>:log</code> or <code>:linear</code>)</li><li><code>kwargs...</code>: Extra keyword arguments for <code>I</code> and <code>v</code> functions (see examples)</li></ul><p><strong>Returns</strong></p><ul><li><code>model</code> object</li></ul><p><strong>Note</strong></p><p>Similar to other DiskWind model constructor but must explicitly pass <code>rMin</code> and <code>rMax</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L504-L525">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.addGrid!" href="#BLR.addGrid!"><code>BLR.addGrid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">addGrid!(m::model, colors=nothing, nϕ::Int=64)</code></pre><p>Add a grid to the model image plot - mostly a debugging tool to visualize grid cells of overlapping models.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to add grid to</li><li><code>colors=nothing</code>: Vector of colors for each submodel (if <code>nothing</code>, uses default colors)</li><li><code>nϕ::Int=64</code>: Number of azimuthal angles to use for the grid</li></ul><p><strong>Returns</strong></p><ul><li><code>::Plots.plot</code>: Plot with grid added</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L338-L350">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.binModel" href="#BLR.binModel"><code>BLR.binModel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">binModel(bins::Union{Int,Vector{Float64}}=100; m::model, yVariable::Union{String,Symbol,Function}, xVariable::Union{String,Symbol,Function}=:v, kwargs...)
binModel(bins::Vector{Float64}, dx::Array{Float64,}; m::model, yVariable::Union{String,Symbol,Function}, xVariable::Union{String,Symbol,Function}=:v, kwargs...)</code></pre><p>Bin the model into a histogram, where each bin is the integrated value of the yVariable as a function of the xVariable.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to bin</li><li><code>yVariable::Union{String,Symbol,Function}</code>: Variable to bin<ul><li>Must be valid attribute of <code>model.rings</code> (e.g. <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li></ul></li><li><code>bins::Union{Int,Vector{Float64}}</code>: Number of bins or bin edges for binning<ul><li>If <code>Int</code>: Number of bins with edges equally spaced between min/max of xVariable</li><li>If <code>Vector{Float64}</code>: Specific bin edges, with number of bins = <code>length(bins)-1</code></li><li>Left edge inclusive, right edge exclusive (except last bin which is inclusive)</li></ul></li><li><code>xVariable::Union{String,Symbol,Function}=:v</code>: Variable to bin over<ul><li>Must be a valid attribute of <code>model.rings</code> or a function that can be applied to <code>model.rings</code></li></ul></li><li><code>dx::Array{Float64,}</code>: Integration element for each bin<ul><li>If provided, used as the associated integral element</li><li>Otherwise defaults to <code>ΔA</code> in each ring struct</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Vector{Float64},Vector{Float64},Vector{Float64}}</code>: A tuple containing:<ul><li><code>binEdges</code>: Bin edges for the xVariable of the histogram</li><li><code>binCenters</code>: Bin centers for the xVariable</li><li><code>yBinned</code>: Binned values of the yVariables</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/profiles.jl#L68-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.binnedSum-Tuple{Array{Float64}, Array{Float64}}" href="#BLR.binnedSum-Tuple{Array{Float64}, Array{Float64}}"><code>BLR.binnedSum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">binnedSum(x::Array{Float64,}, y::Array{Float64, }; bins=100, overflow=false, centered=false, minX=nothing, maxX=nothing)</code></pre><p>Bin the x and y variables into a histogram, where each bin is the sum of the y values for the corresponding x values.</p><p><strong>Arguments</strong></p><ul><li><code>x::Array{Float64,}</code>: x variable to bin over</li><li><code>y::Array{Float64,}</code>: y variable to bin</li><li><code>bins::Union{Int,Vector{Float64}}=100</code>: Number of bins or bin edges for binning<ul><li>If <code>Int</code>: Number of bins with edges equally spaced between min/max of x</li><li>If <code>Vector{Float64}</code>: Specific bin edges, with number of bins = <code>length(bins)-1</code></li><li>Left edge inclusive, right edge exclusive (except last bin which is inclusive)</li></ul></li><li><code>overflow::Bool=false</code>: If <code>true</code>, include values outside bin range in the first/last bins</li><li><code>centered::Bool=false</code>: If <code>true</code>, shift bin edges to center around middle value</li><li><code>minX::Union{Float64,Nothing}=nothing</code>: Minimum value of x for binning (defaults to <code>minimum(x)</code>)</li><li><code>maxX::Union{Float64,Nothing}=nothing</code>: Maximum value of x for binning (defaults to <code>maximum(x)</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Vector{Float64},Vector{Float64},Vector{Float64}}</code>: A tuple containing:<ul><li><code>binEdges</code>: Bin edges for the x variable</li><li><code>binCenters</code>: Bin centers for the x variable</li><li><code>result</code>: Binned sums of the y variable</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/profiles.jl#L2-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.cloudModel-Tuple{Int64}" href="#BLR.cloudModel-Tuple{Int64}"><code>BLR.cloudModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cloudModel(nClouds::Int64; μ::Float64=500., β::Float64=1.0, F::Float64=0.5, rₛ::Float64=1.0, θₒ::Float64=π/2, γ::Float64=1.0, ξ::Float64=1.0, i::Float64=0.0, I::Union{Function,Float64}=IsotropicIntensity, v::Union{Function,Float64}=vCircularCloud, rng::AbstractRNG=Random.GLOBAL_RNG, kwargs...)</code></pre><p>Uses the model constructor to create a cloud model of the BLR similar to Pancoast+ 2011 and 2014.</p><p><strong>Parameters</strong></p><ul><li><code>nClouds::Int64</code>: Number of clouds</li><li><code>μ::Float64=500.</code>: Mean radius of model (in terms of <span>$r_s$</span>)</li><li><code>β::Float64=1.0</code>: Shape parameter for radial distribution</li><li><code>F::Float64=0.5</code>: Minimum fraction of maximum radius where clouds can be placed</li><li><code>rₛ::Float64=1.0</code>: Scale radius (in terms of <span>$r_s$</span>)</li><li><code>θₒ::Float64=π/2</code>: Maximum opening angle of cloud distribution (rad)</li><li><code>γ::Float64=1.0</code>: Disk concentration parameter</li><li><code>ξ::Float64=1.0</code>: Fraction of clouds in back side that have not been moved to the front (when ξ = 1.0 clouds equally distributed front - back and when ξ = 0.0 all clouds are on the front side) </li><li><code>i::Float64=0.0</code>: Inclination angle of system (rad)</li><li><code>I::Union{Function,Float64}=IsotropicIntensity</code>: Intensity function</li><li><code>v::Union{Function,Float64}=vCircularCloud</code>: Velocity function</li><li><code>rng::AbstractRNG=Random.GLOBAL_RNG</code>: Random number generator</li><li><code>kwargs...</code>: Extra keyword arguments for <code>I</code> and <code>v</code> functions (see examples)</li></ul><p><strong>Returns</strong></p><ul><li><code>model</code> object</li></ul><p><strong>Note</strong></p><p>Similar to other <code>cloudModel</code> method but here random values are generated for <code>ϕ₀</code>, <code>rot</code>, and <code>θₒ</code> ,i,rot,θ,θₒ,ξ, rₛ=rₛ,μ=μ,β=β,F=F,I=I,v=v,rng=rng;kwargs...) while keeping <code>i</code> constant for the system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L591-L617">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.cloudModel-Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Float64, Float64}" href="#BLR.cloudModel-Tuple{Vector{Float64}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Float64, Float64}"><code>BLR.cloudModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cloudModel(ϕ₀::Vector{Float64}, i::Vector{Float64}, rot::Vector{Float64}, θₒ::Vector{Float64}, θₒSystem::Float64, ξ::Float64; rₛ::Float64=1.0, μ::Float64=500., β::Float64=1.0, F::Float64=0.5, I::Union{Function,Float64}=IsotropicIntensity, v::Union{Function,Float64}=vCircularCloud, kwargs...)</code></pre><p>Uses the model constructor to create a cloud model of the BLR similar to Pancoast+ 2011 and 2014.</p><p><strong>Parameters</strong></p><ul><li><code>ϕ₀::Vector{Float64}</code>: Initial azimuthal angle of cloud (rad) </li><li><code>i::Vector{Float64}</code>: Inclination angle (rad) </li><li><code>rot::Vector{Float64}</code>: Random rotation of cloud about z axis (rad) </li><li><code>θₒ::Vector{Float64}</code>: Opening angle of cloud (rad) </li><li><code>θₒSystem::Float64</code>: Maximum opening angle of the system (rad) </li><li><code>ξ::Float64</code>: Fraction of clouds in back side that have not been moved to the front (when ξ = 1.0 clouds equally distributed front - back and when ξ = 0.0 all clouds are on the front side) </li></ul><p><strong>Optional Parameters</strong></p><ul><li><code>rₛ::Float64=1.0</code>: Scale radius (in terms of <span>$r_s$</span>)</li><li><code>μ::Float64=500.</code>: Mean radius of model (in terms of <span>$r_s$</span>)</li><li><code>β::Float64=1.0</code>: Shape parameter for radial distribution</li><li><code>F::Float64=0.5</code>: Beginning radius in units of μ where clouds can be placed. </li><li><code>I::Union{Function,Float64}=IsotropicIntensity</code>: Intensity function</li><li><code>v::Union{Function,Float64}=vCircularCloud</code>: Velocity function</li><li><code>kwargs...</code>: Extra keyword arguments for <code>I</code> and <code>v</code> functions (see examples)</li></ul><p><strong>Returns</strong></p><ul><li><code>model</code> object</li></ul><p><strong>Note</strong></p><p>Similar to other <code>cloudModel</code> method but here you must explicitly pass <code>ϕ₀</code>, <code>i</code>, <code>rot</code>, and <code>θₒ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L556-L583">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getFlattenedCameraIndices-Tuple{BLR.model}" href="#BLR.getFlattenedCameraIndices-Tuple{BLR.model}"><code>BLR.getFlattenedCameraIndices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getFlattenedCameraIndices(m::model) -&gt; Vector{Int}</code></pre><p>Get flattened camera indices corresponding to rings in model.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to extract camera indices from</li></ul><p><strong>Returns</strong></p><ul><li><code>camStartInds::Vector{Int}</code>: Vector of camera starting indices with length equal to <code>m.subModelStartInds</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L120-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getProfile-Tuple{BLR.model, Union{Function, String, Symbol}}" href="#BLR.getProfile-Tuple{BLR.model, Union{Function, String, Symbol}}"><code>BLR.getProfile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getProfile(m::model, name::Union{String,Symbol,Function}; 
           bins::Union{Int,Vector{Float64}}=100, 
           dx::Union{Array{Float64,},Nothing}=nothing, kwargs...)</code></pre><p>Return a profile for the model based on the specified name.</p><p><strong>Arguments</strong></p><ul><li><code>m</code>: Model object to get the profile from</li><li><code>name</code>: Name of the profile to get. Options include:<ul><li><code>:line</code>: Returns the line profile (integrated intensity as function of velocity)</li><li><code>:delay</code>: Returns the delay profile (mean delays weighted by intensity/responsivity vs. velocity)</li><li><code>:r</code>: Returns the mean radius (weighted by intensity) as function of velocity </li><li><code>:ϕ</code>: Returns the mean azimuthal angle (weighted by intensity) as function of velocity</li><li><code>:phase</code>: Returns the phase profile (integrated phase as function of velocity)<ul><li>Requires <code>U</code> [Mλ], <code>V</code> [Mλ], <code>PA</code> [rad], and <code>BLRAng</code> [rad] as keyword arguments</li></ul></li><li><code>Function</code>: Returns the intensity weighted mean of this function vs. velocity</li></ul></li><li><code>bins</code>: Number of bins or bin edges for binning<ul><li>If <code>Int</code>: Number of bins with edges equally spaced between min/max velocity</li><li>If <code>Vector{Float64}</code>: Specific bin edges, with number of bins = <code>length(bins)-1</code></li><li>Left edge inclusive, right edge exclusive (except last bin which is inclusive)</li></ul></li><li><code>dx</code>: Integration element for each ring (defaults to <code>ΔA</code> in each ring struct if <code>nothing</code>)</li><li>Additional <code>kwargs</code> passed to <code>binModel</code> include:<ul><li><code>overflow=true</code>: Include overflow bins</li><li><code>centered=true</code>: Center bins around 0.0</li><li><code>minX</code>, <code>maxX</code>: Set min/max bin boundaries</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>profile</code>: A profile object containing bin edges, bin centers, and binned sums. Assign to a model object using <code>setProfile!</code> to store the profile in the model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/profiles.jl#L184-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getRingFromFlattenedInd-Tuple{BLR.model, Int64}" href="#BLR.getRingFromFlattenedInd-Tuple{BLR.model, Int64}"><code>BLR.getRingFromFlattenedInd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getRingFromFlattenedInd(m::model, flattenedInd::Int) -&gt; Tuple{Int, Int}</code></pre><p>Retrieve the model ring index and subindex (if applicable) from flattened array index.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object with rings </li><li><code>flattenedInd::Int</code>: The index in the flattened array we need to work back from</li></ul><p><strong>Returns</strong></p><ul><li><code>row::Int</code>: The ring index in <code>model.rings</code> that the flattened index corresponds to</li><li><code>column::Int</code>: The subindex that matches the flattened index passed to this function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L142-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getVariable-Tuple{BLR.model, Function}" href="#BLR.getVariable-Tuple{BLR.model, Function}"><code>BLR.getVariable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getVariable(m::model, variable::Function; flatten=false) -&gt; Array{Float64}</code></pre><p>Retrieve model variable when specified as a <code>Function</code>. See main docstring for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L250-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getVariable-Tuple{BLR.model, String}" href="#BLR.getVariable-Tuple{BLR.model, String}"><code>BLR.getVariable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getVariable(m::model, variable::Union{String,Symbol,Function}; flatten=false)</code></pre><p>Retrieve elements from model object and stack them into matrices for easy manipulation.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to extract variables from</li><li><code>variable::Union{String,Symbol,Function}</code>: Variable to extract from model<ul><li>If <code>String</code>, will be converted to <code>Symbol</code></li><li>Must be a valid attribute of <code>model.rings</code> (e.g. <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li></ul></li><li><code>flatten::Bool=false</code>: If true, flatten the result to a vector</li></ul><p><strong>Returns</strong></p><ul><li><code>Array{Float64,}</code>: Matrix or vector of extracted variable from <code>model.rings</code>, created by stacking the output variable for each ring<ul><li>For example, if variable given is <code>:I</code>, result will have shape <code>(length(r), length(ϕ))</code> as at each <code>r</code> and <code>ϕ</code> there is a value of <code>I</code></li><li>If <code>flatten=true</code>, result will be a flattened vector</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L186-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getVariable-Tuple{BLR.model, Symbol}" href="#BLR.getVariable-Tuple{BLR.model, Symbol}"><code>BLR.getVariable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getVariable(m::model, variable::Symbol; flatten=false) -&gt; Array{Float64}</code></pre><p>Retrieve model variable when specified as a <code>Symbol</code>. See main docstring for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L209-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.get_r3D-Tuple{Any, Any, Any}" href="#BLR.get_r3D-Tuple{Any, Any, Any}"><code>BLR.get_r3D</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_r3D(i::Float64, rot::Float64, θₒ::Float64) -&gt; Matrix{Float64}</code></pre><p>Calculate rotation matrix to transform from initial XY plane coordinates to 3D space.</p><p><strong>Parameters</strong></p><ul><li><code>i::Float64</code>: Inclination angle of ring (rad)</li><li><code>rot::Float64</code>: Rotation of ring plane about z axis (rad)</li><li><code>θₒ::Float64</code>: Opening angle of point (rad)</li></ul><p><strong>Returns</strong></p><ul><li><code>matrix::Matrix{Float64}</code>: 3×3 rotation matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L383-L395">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getΨ-Tuple{BLR.model, Array{Float64}, Array{Float64}}" href="#BLR.getΨ-Tuple{BLR.model, Array{Float64}, Array{Float64}}"><code>BLR.getΨ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getΨ(m::model,vEdges::Array{Float64},tEdges::Array{Float64})</code></pre><p>Calculate the 2D transfer function Ψ for a model <code>m</code> over specified velocity and time bins, whose edges are given by <code>vEdges</code> and <code>tEdges</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/transfer.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getΨ-Tuple{BLR.model, Int64, Int64}" href="#BLR.getΨ-Tuple{BLR.model, Int64, Int64}"><code>BLR.getΨ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getΨ(m::model,vBins::Int64,tBins::Int64)</code></pre><p>Calculate the 2D transfer function Ψ for a model <code>m</code> over specified number of velocity bins <code>vBins</code> and time bins <code>tBins</code>. The velocity and time edges are automatically calculated based on the minimum and maximum values for velocity and delays in the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/transfer.jl#L34-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getΨt" href="#BLR.getΨt"><code>BLR.getΨt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getΨt(m::model,tBins::Int64,maxT::Float64=Inf,overflow::Bool=false)</code></pre><p>Calculate the 1D transfer function Ψ(t) for a model <code>m</code> over specified number of time bins <code>tBins</code>. The <code>maxT</code> parameter specifies the maximum time delay to consider, and <code>overflow</code> determines whether to include contributions from delays outside the specified edges in the edge bins.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/transfer.jl#L82-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.getΨt" href="#BLR.getΨt"><code>BLR.getΨt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getΨt(m::model,tEdges::Array{Float64},overflow::Bool=false;)</code></pre><p>Calculate the 1D transfer function Ψ(t) for a model <code>m</code> over specified time edges <code>tEdges</code>. The <code>overflow</code> parameter determines whether to include contributions from delays outside the specified edges in the edge bins.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/transfer.jl#L54-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.image!-Tuple" href="#BLR.image!-Tuple"><code>BLR.image!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BLR.image(m::model, variable::Union{String,Symbol,Function}, kwargs...)</code></pre><p>Generate an image of the model where the color of each point is determined by the variable provided.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to extract variable from</li><li><code>variable::Union{String,Symbol,Function}</code>: Variable to extract from model<ul><li>If <code>String</code>, will be converted to <code>Symbol</code></li><li>Must be a valid attribute of <code>model.rings</code> (e.g. <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li></ul></li></ul><p><strong>Keywords</strong></p><ul><li>Additional keyword arguments are passed to <code>Plots.plot</code></li></ul><p><strong>Returns</strong></p><ul><li><code>p::Plots.plot</code>: Plot object representing the generated image</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L293-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.image!-Tuple{RecipesBase.AbstractPlot, Vararg{Any}}" href="#BLR.image!-Tuple{RecipesBase.AbstractPlot, Vararg{Any}}"><code>BLR.image!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BLR.image(m::model, variable::Union{String,Symbol,Function}, kwargs...)</code></pre><p>Generate an image of the model where the color of each point is determined by the variable provided.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to extract variable from</li><li><code>variable::Union{String,Symbol,Function}</code>: Variable to extract from model<ul><li>If <code>String</code>, will be converted to <code>Symbol</code></li><li>Must be a valid attribute of <code>model.rings</code> (e.g. <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li></ul></li></ul><p><strong>Keywords</strong></p><ul><li>Additional keyword arguments are passed to <code>Plots.plot</code></li></ul><p><strong>Returns</strong></p><ul><li><code>p::Plots.plot</code>: Plot object representing the generated image</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L293-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.image-Tuple" href="#BLR.image-Tuple"><code>BLR.image</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BLR.image(m::model, variable::Union{String,Symbol,Function}, kwargs...)</code></pre><p>Generate an image of the model where the color of each point is determined by the variable provided.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to extract variable from</li><li><code>variable::Union{String,Symbol,Function}</code>: Variable to extract from model<ul><li>If <code>String</code>, will be converted to <code>Symbol</code></li><li>Must be a valid attribute of <code>model.rings</code> (e.g. <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li></ul></li></ul><p><strong>Keywords</strong></p><ul><li>Additional keyword arguments are passed to <code>Plots.plot</code></li></ul><p><strong>Returns</strong></p><ul><li><code>p::Plots.plot</code>: Plot object representing the generated image</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L293-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.phase-Tuple{BLR.model}" href="#BLR.phase-Tuple{BLR.model}"><code>BLR.phase</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">phase(m::model; U, V, PA, BLRAng, returnAvg=false, offAxisInds=nothing, kwargs...)</code></pre><p>Calculate differential phase for a model ring.</p><p><strong>Description</strong></p><p>Computes the differential phase signal that would be measured by an interferometer  for specified baselines, model orientation, and BLR angular size.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model object to calculate phase for</li><li><code>U::Vector{Float64}</code>: U component of complex visibility in [Mλ]</li><li><code>V::Vector{Float64}</code>: V component of complex visibility in [Mλ]</li><li><code>PA::Float64</code>: On-sky position angle of the model in radians</li><li><code>BLRAng::Float64</code>: Characteristic size of the BLR model in radians (conversion from <span>$r_s$</span> to radians)</li><li><code>returnAvg::Bool=false</code>: If <code>true</code>, returns the average phase across all baselines</li><li><code>offAxisInds::Union{Nothing,Vector{Int}}=nothing</code>: If provided, only calculates phase for baselines at specified indices</li></ul><p><strong>Returns</strong></p><ul><li>If <code>returnAvg=true</code>: <code>Tuple{Vector{Float64},Vector{Float64},Vector{Float64}}</code> containing:<ul><li>Bin edges for velocity</li><li>Bin centers for velocity</li><li>Average differential phase (in radians)</li></ul></li><li>If <code>returnAvg=false</code>: <code>Vector{Tuple{Vector{Float64},Vector{Float64},Vector{Float64}}}</code> containing:<ul><li>For each baseline, a tuple of bin edges, bin centers, and differential phase</li></ul></li></ul><p>The differential phase is calculated by integrating the phase over the model at each velocity bin, weighted by the intensity and area of each ring element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/profiles.jl#L127-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.photograph" href="#BLR.photograph"><code>BLR.photograph</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">photograph(r::Float64, ϕ₀::Float64, i::Float64, rot::Float64, θₒ::Float64, reflect::Bool=false)</code></pre><p>Calculate the image coordinates from system coordinates r, ϕ + inclination angle i.</p><p><strong>Arguments</strong></p><ul><li><code>r::Float64</code>: radius from central mass (in terms of rₛ)</li><li><code>ϕ₀::Float64</code>: unrotated azimuthal angle in ring plane (rad)</li><li><code>i::Float64</code>: inclination angle of ring plane (rad)</li><li><code>rot::Float64</code>: rotation of system plane about z axis (rad)</li><li><code>θₒ::Float64</code>: ring opening angle</li><li><code>reflect::Bool=false</code>: whether the point is reflected across the midplane of the disk</li></ul><p><strong>Returns</strong></p><ul><li><code>α::Float64</code>: image x coordinate (in terms of rₛ)</li><li><code>β::Float64</code>: image y coordinate (in terms of rₛ)</li></ul><p><strong>Note</strong></p><p>This function is <em>coordinate</em> photography only. To visualize models, see <code>Image</code>.`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/raytrace.jl#L89-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.plot3d!-Tuple" href="#BLR.plot3d!-Tuple"><code>BLR.plot3d!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot3d(m::model, [variable], [annotatedCamera], [kwargs...])</code></pre><p>Generate a 3D plot of the model geometry, optionally colored by a variable.</p><p><strong>Parameters</strong></p><ul><li><code>m::model</code>: Model object to plot</li><li><code>variable::Union{String,Symbol,Function}=nothing</code>: Variable to color the points by<ul><li>If <code>String</code>, will be converted to <code>Symbol</code></li><li>Must be a valid attribute of <code>model.rings</code> (e.g., <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li><li>If not provided, defaults to <code>nothing</code> (no coloring)</li></ul></li><li><code>annotatedCamera::Bool=true</code>: Whether to annotate the camera position and orientation in the plot</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>Plots.plot</code></li></ul><p><strong>Returns</strong></p><ul><li><code>p::Plots.plot</code>: 3D plot of the model geometry, optionally colored by the variable provided</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L452-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.plot3d!-Tuple{RecipesBase.AbstractPlot, Vararg{Any}}" href="#BLR.plot3d!-Tuple{RecipesBase.AbstractPlot, Vararg{Any}}"><code>BLR.plot3d!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot3d(m::model, [variable], [annotatedCamera], [kwargs...])</code></pre><p>Generate a 3D plot of the model geometry, optionally colored by a variable.</p><p><strong>Parameters</strong></p><ul><li><code>m::model</code>: Model object to plot</li><li><code>variable::Union{String,Symbol,Function}=nothing</code>: Variable to color the points by<ul><li>If <code>String</code>, will be converted to <code>Symbol</code></li><li>Must be a valid attribute of <code>model.rings</code> (e.g., <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li><li>If not provided, defaults to <code>nothing</code> (no coloring)</li></ul></li><li><code>annotatedCamera::Bool=true</code>: Whether to annotate the camera position and orientation in the plot</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>Plots.plot</code></li></ul><p><strong>Returns</strong></p><ul><li><code>p::Plots.plot</code>: 3D plot of the model geometry, optionally colored by the variable provided</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L452-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.plot3d-Tuple" href="#BLR.plot3d-Tuple"><code>BLR.plot3d</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot3d(m::model, [variable], [annotatedCamera], [kwargs...])</code></pre><p>Generate a 3D plot of the model geometry, optionally colored by a variable.</p><p><strong>Parameters</strong></p><ul><li><code>m::model</code>: Model object to plot</li><li><code>variable::Union{String,Symbol,Function}=nothing</code>: Variable to color the points by<ul><li>If <code>String</code>, will be converted to <code>Symbol</code></li><li>Must be a valid attribute of <code>model.rings</code> (e.g., <code>:I</code>, <code>:v</code>, <code>:r</code>, <code>:e</code>, <code>:i</code>, <code>:ϕ</code>) or a function that can be applied to <code>model.rings</code></li><li>Example: Keplerian disk time delays could be calculated like <code>t(ring) = ring.r*(1 .+ sin.(ring.ϕ).*ring.i))</code></li><li>If not provided, defaults to <code>nothing</code> (no coloring)</li></ul></li><li><code>annotatedCamera::Bool=true</code>: Whether to annotate the camera position and orientation in the plot</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>Plots.plot</code></li></ul><p><strong>Returns</strong></p><ul><li><code>p::Plots.plot</code>: 3D plot of the model geometry, optionally colored by the variable provided</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L452-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.profile!-Tuple" href="#BLR.profile!-Tuple"><code>BLR.profile!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">profile(m::model, [variable], [kwargs...])</code></pre><p>Plot all profiles set in the model, normalized to the maximum value of each profile.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: A model object containing profile data.</li><li><code>variable</code>: Optional. A symbol or string (or list of symbols/strings) specifying which profile to plot. If not provided, all profiles set in model will be plotted.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>Plots.plot</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L632-L641">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.profile!-Tuple{RecipesBase.AbstractPlot, Vararg{Any}}" href="#BLR.profile!-Tuple{RecipesBase.AbstractPlot, Vararg{Any}}"><code>BLR.profile!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">profile(m::model, [variable], [kwargs...])</code></pre><p>Plot all profiles set in the model, normalized to the maximum value of each profile.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: A model object containing profile data.</li><li><code>variable</code>: Optional. A symbol or string (or list of symbols/strings) specifying which profile to plot. If not provided, all profiles set in model will be plotted.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>Plots.plot</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L632-L641">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.raytrace!-Tuple{BLR.model}" href="#BLR.raytrace!-Tuple{BLR.model}"><code>BLR.raytrace!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">raytrace!(m::model; IRatios::Union{Float64,Array{Float64,}}=1.0, τCutOff::Float64=1.0, raytraceFreeClouds::Bool=false)</code></pre><p>Perform raytracing for a model, combining overlapping components along line of sight.</p><p>This function should be called after combining all relevant models (i.e. <code>mCombined = m1 + m2 + m3...</code>). It performs raytracing in discrete steps (no absorption, only adding intensity in chunks along  the line of sight until maximum optical depth <code>τ</code> is reached) and generates a new model object  with extraneous points removed. Note that this function will mutate the input model objects.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model to raytrace</li><li><code>IRatios::Union{Float64,Array{Float64,}}=1.0</code>: Intensity ratios for each submodel<ul><li>If <code>Float64</code>, applies to all submodels equally</li><li>If array, applies to each submodel individually (must match number of submodels)</li><li>Used when combining models with different intensity functions if they aren&#39;t properly normalized</li></ul></li><li><code>τCutOff::Float64=1.0</code>: Maximum optical depth to raytrace to (stops when <code>τ &gt; τCutOff</code>)</li><li><code>raytraceFreeClouds::Bool=false</code>: Whether to raytrace free clouds (cloud-cloud raytracing)<ul><li>If <code>false</code>, clouds are only raytraced if they overlap with a continuous model</li><li>If <code>true</code>, clouds will be checked for overlap with other clouds and raytraced accordingly</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>m::model</code>: Model with raytraced points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/raytrace.jl#L286-L309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.raytrace-NTuple{5, Float64}" href="#BLR.raytrace-NTuple{5, Float64}"><code>BLR.raytrace</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">raytrace(α::Float64, β::Float64, i::Float64, rot::Float64, θₒPoint::Float64)</code></pre><p>Calculate where ray traced back from camera coordinates <code>α</code> and <code>β</code> intersects the system (assumes circular geometry).</p><p><strong>Arguments</strong></p><ul><li><code>α::Float64</code>: image x coordinate (in terms of rₛ)</li><li><code>β::Float64</code>: image y coordinate (in terms of rₛ)</li><li><code>i::Float64</code>: inclination angle of system (rad)</li><li><code>rot::Float64</code>: how the point was rotated about z axis (rad)</li><li><code>θₒPoint::Float64</code>: opening angle of current point</li></ul><p><strong>Returns</strong></p><ul><li><code>r::Float64</code>: distance from central mass (in terms of rₛ)</li><li><code>ϕ::Float64</code>: azimuthal angle of system ring plane at intersection</li><li><code>ϕ₀::Float64</code>: original azimuthal angle in ring plane (no rotation)</li></ul><p><strong>Note</strong></p><p>This function is <em>coordinate</em> raytracing only. To raytrace models and combine intensities, see <code>raytrace!</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/raytrace.jl#L4-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.raytrace-Tuple{Float64, Float64, Float64, Float64, Float64, Matrix{Float64}, Vector{Float64}, Matrix{Float64}, Vector{Float64}}" href="#BLR.raytrace-Tuple{Float64, Float64, Float64, Float64, Float64, Matrix{Float64}, Vector{Float64}, Matrix{Float64}, Vector{Float64}}"><code>BLR.raytrace</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">raytrace(α::Float64, β::Float64, i::Float64, rot::Float64, θₒPoint::Float64, r3D::Matrix{Float64}, xyz::Vector{Float64}, matBuff::Matrix{Float64}, colBuff::Vector{Float64})</code></pre><p>Performant version of <code>raytrace</code> function – calculate where ray traced back from camera coordinates <code>α</code>, <code>β</code> intersects the system (assumes circular geometry).</p><p><strong>Arguments</strong></p><ul><li><code>α::Float64</code>: image x coordinate (in terms of rₛ)</li><li><code>β::Float64</code>: image y coordinate (in terms of rₛ)</li><li><code>i::Float64</code>: inclination angle of system (rad)</li><li><code>rot::Float64</code>: rotation of current point about z axis (rad)</li><li><code>θₒPoint::Float64</code>: opening angle of current point</li><li><code>r3D::Matrix{Float64}</code>: matrix that rotates system plane into XY plane</li><li><code>xyz::Vector{Float64}</code>: preallocated xyz vector (but not precalculated)</li><li><code>matBuff::Matrix{Float64}</code>: preallocated buffer matrix for storing result of 3x3 matrix multiplication</li><li><code>colBuff::Vector{Float64}</code>: preallocated buffer vector for storing final matrix multiplication result</li></ul><p><strong>Returns</strong></p><ul><li><code>r::Float64</code>: distance from central mass (in terms of rₛ)</li><li><code>ϕ::Float64</code>: azimuthal angle of system ring plane at intersection</li><li><code>ϕ₀::Float64</code>: original azimuthal angle in ring plane</li></ul><p><strong>Note</strong></p><p>This function is <em>coordinate</em> raytracing only. To raytrace models and combine intensities, see <code>raytrace!</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/raytrace.jl#L34-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.reflect!-Tuple{Any, Any}" href="#BLR.reflect!-Tuple{Any, Any}"><code>BLR.reflect!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reflect!(xyzSys::Vector{Float64}, i::Float64) -&gt; Vector{Float64}</code></pre><p>Reflect coordinates in 3D space across the ring plane.</p><p><strong>Parameters</strong></p><ul><li><code>xyzSys::Vector{Float64}</code>: <code>[x;y;z]</code> coordinates in 3D space</li><li><code>i::Float64}</code>: Inclination angle of ring plane (rad)</li></ul><p><strong>Returns</strong></p><ul><li><code>xyzSys::Vector{Float64}</code>: <code>[x&#39;;y&#39;;z&#39;]</code> coordinates in 3D space after reflection</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L404-L415">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.removeDiskObscuredClouds!" href="#BLR.removeDiskObscuredClouds!"><code>BLR.removeDiskObscuredClouds!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">removeDiskObscuredClouds!(m::model, rotate3D::Function=rotate3D)</code></pre><p>Remove clouds that are obscured by the disk.</p><p>Performs simple raytracing for an optically thick obscuring disk. The function modifies the input model by removing cloud points that are obscured by the disk. Note that this is a mutating operation and the input model will be modified in place.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model to remove disk obscured clouds. Should be a combined model consisting  of a disk component and a cloud component.</li><li><code>rotate3D::Function=rotate3D</code>: Function to rotate coordinates in 3D space</li></ul><p><strong>Returns</strong></p><ul><li><code>m::model</code>: Model with disk obscured clouds removed</li></ul><p><strong>See also</strong></p><ul><li><code>zeroDiskObscuredClouds!</code>: Function to zero out disk obscured clouds instead of removing them</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/raytrace.jl#L185-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.removeNaN!-Tuple{BLR.model}" href="#BLR.removeNaN!-Tuple{BLR.model}"><code>BLR.removeNaN!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">removeNaN!(m::model) -&gt; model</code></pre><p>Remove points with <code>I = NaN</code> from model.</p><p><strong>Parameters</strong></p><ul><li><code>m::model</code>: Model to remove points from</li></ul><p><strong>Returns</strong></p><ul><li><code>m::model</code>: Model with NaN points removed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L23-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.reset!-Tuple{BLR.model}" href="#BLR.reset!-Tuple{BLR.model}"><code>BLR.reset!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset!(m::model; profiles=true, img=false)</code></pre><p>Erase existing profiles/imgs.</p><p><strong>Parameters</strong></p><ul><li><code>m::model</code>: Model object to reset</li><li><code>profiles::Bool=true</code>: If true, reset profiles</li><li><code>img::Bool=false</code>: If true, reset raytracing boolean (does not change existing model but allows model to be raytraced again after combining other new models)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.response-Tuple{Float64}" href="#BLR.response-Tuple{Float64}"><code>BLR.response</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">response(r::Float64; ηₒ::Float64=0.5, η₁::Float64=0.5, αRM::Float64=0.0, rNorm::Float64=1.0, _...)</code></pre><p>Calculate response function for use in reverberation mapping calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/transfer.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.rotate3D" href="#BLR.rotate3D"><code>BLR.rotate3D</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rotate3D(r::Float64, ϕ₀::Float64, i::Float64, rot::Float64, θₒ::Float64, reflect::Bool=false) -&gt; Tuple{Float64, Float64, Float64}</code></pre><p>Transform from ring coordinates to 3D coordinates where camera is at +x.</p><p><strong>Parameters</strong></p><ul><li><code>r::Float64</code>: Radius from central mass (in terms of rₛ)</li><li><code>ϕ₀::Float64</code>: Starting azimuthal angle in ring plane (rad)</li><li><code>i::Float64</code>: Inclination angle of ring plane (rad)</li><li><code>rot::Float64</code>: Rotation of system plane about z axis (rad)</li><li><code>θₒ::Float64</code>: Opening angle of point (rad)</li><li><code>reflect::Bool=false</code>: Whether to reflect across the ring plane</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Float64, Float64, Float64}</code>: <code>(x, y, z)</code> coordinates in 3D space</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L425-L440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.setProfile!-Tuple{BLR.model, profile}" href="#BLR.setProfile!-Tuple{BLR.model, profile}"><code>BLR.setProfile!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setProfile!(m::model, p::profile; overwrite::Bool=false)</code></pre><p>Set a profile in the model&#39;s profiles dictionary. If the profile already exists and overwrite is false, a warning is issued.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/profiles.jl#L249-L253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.t-Tuple{BLR.ring}" href="#BLR.t-Tuple{BLR.ring}"><code>BLR.t</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tDisk(ring::ring; kwargs...)</code></pre><p>Calculate time delays for a point in a disk as <span>$t = \eta r \left(1 + \cos(\phi) \sin(i)\right)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/profiles.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.vCirc" href="#BLR.vCirc"><code>BLR.vCirc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vCirc(r::Float64, rₛ::Float64=1.0)</code></pre><p>Calculate circular velocity at radius <code>r</code> from central mass, with Schwarzschild radius <code>rₛ</code>.</p><p>Defaults to <code>rₛ=1.0</code> for unitless calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/velocity.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.vCircularCloud-Tuple{}" href="#BLR.vCircularCloud-Tuple{}"><code>BLR.vCircularCloud</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vCircularCloud(;r::Float64, ϕ₀::Float64, i::Float64, rot::Float64, θₒ::Float64, rₛ::Float64=1.0, reflect::Bool=false, _...)</code></pre><p>Calculate line of sight velocity for cloud in 3D space.</p><p><strong>Arguments</strong></p><ul><li><code>r::Float64</code>: radius from central mass (in terms of <code>rₛ</code>)</li><li><code>ϕ₀::Float64</code>: starting azimuthal angle in ring plane (rad)</li><li><code>i::Float64</code>: inclination angle of ring plane (rad)</li><li><code>rot::Float64</code>: rotation of system plane about z axis (rad)</li><li><code>θₒ::Float64</code>: opening angle of point</li><li><code>rₛ::Float64=1.0</code>: Schwarzschild radius (optional, to convert to physical units)</li><li><code>reflect::Bool=false</code>: whether the point is reflected across the midplane of the disk</li><li><code>_...</code>: extra kwargs, ignored</li></ul><p><strong>Returns</strong></p><ul><li>Line of sight velocity (<code>Float64</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/velocity.jl#L34-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.vCircularDisk-Tuple{}" href="#BLR.vCircularDisk-Tuple{}"><code>BLR.vCircularDisk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vCircularDisk(;r::Union{Float64,Vector{Float64}}, i::Float64, ϕ::Union{Vector{Float64},Float64}, θₒ::Union{Vector{Float64},Float64}, rₛ=1.0, _...)</code></pre><p>Calculate line of sight velocity for circular orbit at radius <code>r</code> from central mass and inclined at angle <code>i</code> (rad) over grid of azimuthal angles <code>ϕ</code> (rad).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/velocity.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.vCircularRadialDisk-Tuple{}" href="#BLR.vCircularRadialDisk-Tuple{}"><code>BLR.vCircularRadialDisk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vCircularRadialDisk(;r::Union{Float64,Vector{Float64}}, i::Float64, ϕ::Union{Vector{Float64},Float64}, vᵣFrac::Union{Vector{Float64},Float64}=0.0, inflow::Union{Vector{Bool},Bool}=true, rₛ=1.0, _...)</code></pre><p>Calculate line of sight velocity for circular orbit at radius <code>r</code> from central mass and inclined at angle <code>i</code> (rad) over grid of azimuthal angles <code>ϕ</code> (rad) with radial inflow/outflow.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/velocity.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.vCloudTurbulentEllipticalFlow-Tuple{}" href="#BLR.vCloudTurbulentEllipticalFlow-Tuple{}"><code>BLR.vCloudTurbulentEllipticalFlow</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vCloudTurbulentEllipticalFlow(;σρᵣ::Float64, σρc::Float64, σΘᵣ::Float64, σΘc::Float64, θₑ::Float64, fEllipse::Float64, fFlow::Float64, σₜ::Float64, r::Float64, i::Float64, rot::Float64, θₒ::Float64, rₛ::Float64=1.0, ϕ₀::Float64=0.0, reflect::Bool=false, rng::AbstractRNG=Random.GLOBAL_RNG, _...)</code></pre><p>Calculate line of sight velocity for cloud in 3D space with potential for elliptical orbital velocities, in/outflow, and turbulence as in Pancoast+14.</p><p><strong>Arguments</strong></p><ul><li><code>σρᵣ::Float64</code>: Radial standard deviation around radial orbits</li><li><code>σρc::Float64</code>: Radial standard deviation around circular orbits</li><li><code>σΘᵣ::Float64</code>: Angular standard deviation around radial orbits</li><li><code>σΘc::Float64</code>: Angular standard deviation around circular orbits</li><li><code>θₑ::Float64</code>: Angle in v<em>ϕ-v</em>r plane</li><li><code>fEllipse::Float64</code>: Fraction of elliptical orbits</li><li><code>fFlow::Float64</code>: If &lt; 0.5, inflow, otherwise, outflow</li><li><code>σₜ::Float64</code>: Standard deviation of turbulent velocity </li><li><code>r::Float64</code>: Radius from central mass (in terms of <code>rₛ</code>)</li><li><code>i::Float64</code>: Inclination angle of ring plane (rad)</li><li><code>rot::Float64</code>: Rotation of system plane about z axis (rad)</li><li><code>θₒ::Float64</code>: Opening angle of point</li><li><code>rₛ::Float64=1.0</code>: Schwarzschild radius (optional, to convert to physical units)</li><li><code>ϕ₀::Float64=0.0</code>: Starting azimuthal angle in ring plane (rad)</li><li><code>reflect::Bool=false</code>: Whether the point is reflected across the midplane of the disk</li><li><code>rng::AbstractRNG=Random.GLOBAL_RNG</code>: Random number generator</li><li><code>_...</code>: Extra kwargs, ignored</li></ul><p><strong>Returns</strong></p><ul><li>Line of sight velocity (<code>Float64</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/velocity.jl#L63-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.zeroDiskObscuredClouds!-Tuple{BLR.model}" href="#BLR.zeroDiskObscuredClouds!-Tuple{BLR.model}"><code>BLR.zeroDiskObscuredClouds!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zeroDiskObscuredClouds!(m::model; diskCloudIntensityRatio::Float64=1.0, rotate3D::Function=rotate3D)</code></pre><p>Zero out the intensities of clouds that are obscured by the disk.</p><p>Performs simple raytracing for an optically thick obscuring disk. The function modifies the input model by setting the intensity of obscured cloud points to zero and adjusting the disk intensity according to the specified ratio.</p><p><strong>Arguments</strong></p><ul><li><code>m::model</code>: Model to zero out disk obscured clouds. Should be a combined model consisting of a disk component and a cloud component. </li><li><code>diskCloudIntensityRatio::Float64=1.0</code>: Ratio of disk to cloud intensity, used to scale  the disk intensities after zeroing out clouds</li><li><code>rotate3D::Function=rotate3D</code>: Function to rotate coordinates in 3D space</li></ul><p><strong>Returns</strong></p><ul><li><code>m::model</code>: Model with disk obscured clouds zeroed out</li></ul><p><strong>See also</strong></p><ul><li><code>removeDiskObscuredClouds!</code>: Function to remove disk obscured clouds instead of zeroing them out</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/raytrace.jl#L116-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.camera" href="#BLR.camera"><code>BLR.camera</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">camera</code></pre><p>Camera coordinates struct.</p><p><strong>Fields</strong></p><ul><li><code>α::Union{Vector{Float64}, Matrix{Float64}}</code>: x values in the camera plane</li><li><code>β::Union{Vector{Float64}, Matrix{Float64}}</code>: y values in the camera plane</li><li><code>raytraced::Bool</code>: whether the camera has been used to raytrace the model</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L330-L339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.model" href="#BLR.model"><code>BLR.model</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">model</code></pre><p>A mutable structure to hold many rings and their parameters that model the BLR.</p><p><strong>Fields</strong></p><ul><li><code>rings::Vector{ring}</code>: List of ring objects, see <code>ring</code> struct</li><li><code>profiles::Union{Nothing,Dict{Symbol,profile}}</code>: Dictionary of profiles (see <code>profile</code> struct) with keys as symbols; optional, usually initialized to empty dictionary and filled in with <code>setProfile!</code></li><li><code>camera::Union{Nothing,camera}</code>: Camera coordinates (α,β) corresponding to each ring used to generate images and in raytracing, see <code>camera</code> struct</li><li><code>subModelStartInds::Vector{Int}</code>: Indices of start of each submodel in list of rings; used to separate out submodels for raytracing or for the recovery of individual models after being combined</li></ul><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">model(rings::Vector{ring}, profiles::Union{Nothing,Dict{Symbol,profile}}, camera::Union{Nothing,camera}, subModelStartInds::Vector{Int}) </code></pre><ul><li>the most flexible constructor, takes in user supplied vector of <code>ring</code> objects, optional dictionary of profiles, optional camera coordinates, and vector of indices for submodels</li></ul><pre><code class="language-julia hljs">model(rings::Vector{ring{Vector{Float64},Float64}})</code></pre><ul><li>cloud model constructor, takes in a vector of ring objects that are each points in space and returns a model object with camera coordinates calculated from the physical parameters of each ring</li></ul><pre><code class="language-julia hljs">model(rMin::Float64, rMax::Float64, i::Float64, nr::Int, nϕ::Int, I::Function, v::Function, scale::Symbol; kwargs...)</code></pre><ul><li>disk-wind model constructor, takes in minimum and maximum radius, inclination angle, number of radial and azimuthal bins, intensity and velocity functions, and scale for radial binning; returns a model object with rings generated from these parameters</li></ul><pre><code class="language-julia hljs">model(r̄::Float64, rFac::Float64, Sα::Float64, i::Float64, nr::Int, nϕ::Int, scale::Symbol; kwargs...)</code></pre><ul><li>disk-wind model constructor, takes in average radius, radius scaling factor, power law for source function, inclination angle, number of radial and azimuthal bins, and scale for radial binning; returns a model object with rings generated from these parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L353-L382">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.profile" href="#BLR.profile"><code>BLR.profile</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">profile</code></pre><p>A struct to hold binned data, usually bound to model struct with <code>profiles.jl#setProfile!</code>.</p><p><strong>Fields</strong></p><ul><li><code>name::Symbol</code>: Name of profile</li><li><code>binCenters::Vector{Float64}</code>: Bin centers </li><li><code>binEdges::Vector{Float64}</code>: Bin edges</li><li><code>binSums::Vector{Float64}</code>: Sum of values in each bin (crude integral over bin)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L308-L318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.profile-Tuple" href="#BLR.profile-Tuple"><code>BLR.profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">profile(m::model, [variable], [kwargs...])</code></pre><p>Plot all profiles set in the model, normalized to the maximum value of each profile.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: A model object containing profile data.</li><li><code>variable</code>: Optional. A symbol or string (or list of symbols/strings) specifying which profile to plot. If not provided, all profiles set in model will be plotted.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>Plots.plot</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/util.jl#L632-L641">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BLR.ring" href="#BLR.ring"><code>BLR.ring</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ring{V,F} &lt;: AbstractRing{V,F}</code></pre><p>A mutable structure to hold parameters of each model ring, where the &quot;ring&quot; is a circle in the camera plane observing the BLR.</p><p><strong>Fields</strong></p><ul><li><p><code>r</code>: Distance from central mass (in terms of <span>$r_s$</span>)</p><ul><li><code>Union{Vector{Float64}, Float64, Function}</code></li><li>Can be a single value for constant radius, or vector corresponding to azimuthal angles</li><li>Can be a function returning <code>Vector{Float64}</code> or <code>Float64</code></li></ul></li><li><p><code>i</code>: Inclination angle in radians</p><ul><li><code>Union{Vector{Float64}, Float64}</code></li><li>Must be between 0 and <span>$\pi/2$</span>, with 0 being face-on and <span>$\pi/2$</span> being edge-on</li></ul></li><li><p><code>rot</code>: Rotation of system plane about z-axis in radians</p><ul><li><code>Union{Vector{Float64}, Float64}</code></li></ul></li><li><p><code>θₒ</code>: Opening angle of ring in radians</p><ul><li><code>Union{Vector{Float64}, Float64}</code></li><li>Should be between 0 and <span>$\pi/2$</span></li></ul></li><li><p><code>v</code>: Line of sight velocity</p><ul><li><code>Union{Vector{Float64}, Float64, Function}</code></li><li>Can be a function that calculates velocity from other parameters</li></ul></li><li><p><code>I</code>: Intensity</p><ul><li><code>Union{Vector{Float64}, Float64, Matrix{Float64}, Function}</code></li><li>Can be a function that calculates intensity from other parameters</li></ul></li><li><p><code>ϕ</code>: Azimuthal angle in radians</p><ul><li><code>Union{Vector{Float64}, Float64}</code></li></ul></li><li><p><code>ϕ₀</code>: Initial azimuthal angle before rotation in radians</p><ul><li><code>Union{Vector{Float64}, Float64}</code></li><li>Defaults to 0.0 if not provided or if <code>rot</code> is 0.0</li></ul></li><li><p><code>ΔA</code>: Projected area of each ring element in image</p><ul><li><code>Union{Vector{Float64}, Float64}</code></li><li>Used in calculating profiles</li></ul></li><li><p><code>reflect</code>: Whether cloud is reflected across disk mid-plane</p><ul><li><code>Union{Bool, Array{Bool,}}</code></li></ul></li><li><p><code>τ</code>: Optical depth</p><ul><li><code>Union{Vector{Float64}, Float64, Function}</code></li></ul></li><li><p><code>η</code>: Response parameter for reverberation</p><ul><li><code>Union{Vector{Float64}, Float64, Function}</code></li></ul></li><li><p><code>Δr</code>: Distance between camera pixels in r</p><ul><li><code>Float64</code></li></ul></li><li><p><code>Δϕ</code>: Distance between camera pixels in ϕ</p><ul><li><code>Float64</code></li></ul></li><li><p><code>scale</code>: Encoding for camera ring scaling</p><ul><li><code>Union{Nothing, Symbol}</code></li><li><code>:log</code> or <code>:linear</code> scale</li></ul></li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">ring(; r, i, v, I, ϕ, rot=0.0, θₒ=0.0, ϕ₀=0.0, ΔA=1.0, reflect=false, τ=0.0, η=1.0, Δr=1.0, Δϕ=1.0, scale=nothing, kwargs...)</code></pre><p>Required parameters:</p><ul><li><code>r</code>, <code>i</code>, <code>v</code>, <code>I</code>, <code>ϕ</code></li></ul><p>Optional parameters with defaults:</p><ul><li><code>rot=0.0</code>, <code>θₒ=0.0</code>, <code>ϕ₀=0.0</code>, <code>ΔA=1.0</code>, <code>reflect=false</code>, <code>τ=0.0</code>, <code>η=1.0</code>, <code>Δr=1.0</code>, <code>Δϕ=1.0</code>, <code>scale=nothing</code></li></ul><p>Additional keyword arguments are passed to the <code>r</code>, <code>v</code>, <code>I</code>, and <code>τ</code> functions if they are provided as functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/kirklong/BLR.jl/blob/60acc033c954dc53831d215811f0adbb13fc87de/src/structs.jl#L4-L78">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage_examples/">« Usage and Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Wednesday 18 June 2025 17:43">Wednesday 18 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
